import{_ as i,c as n,a as t,b as e,d as o,o as s}from"./app-Cp1NnjgO.js";const r={};function l(c,a){return s(),n("div",null,a[0]||(a[0]=[t('<h2 id="section-6-4-sql-injection" tabindex="-1"><a class="header-anchor" href="#section-6-4-sql-injection"><span>Section 6.4 SQL Injection</span></a></h2><p>As you study this section, answer the following questions:</p><ul><li>What is Structured Query Language (SQL) injection?</li><li>Why are SQL attacks common?</li><li>What are the SQL methodology steps?</li><li>What measures can you take to actively defend against SQL injection attacks?</li></ul><p>In this section, you will learn to:</p><ul><li>Exploit SQL on a web page</li><li>FindSQL injection flaws with sqlmap</li><li>Explore SQL injection flaws</li><li>Detect SQL injection flaws with Burp Suite</li></ul><p>The key terms for this section include:</p><p><strong>Key Terms and Definitions</strong></p>',7),e("table",{class:"terms"},[e("caption",{class:"fw-bold"},"Key Terms and Definitions"),e("thead",null,[e("tr",null,[e("th",{class_:"firstTableHeader",scope:"col",class:"fw-bold"}," Term"),e("th",{scope:"col",class:"fw-bold"}," Definition")])]),e("tbody",null,[e("tr",null,[e("td",null,"Remote code execution"),e("td",null,"A common form of cyber attack where the attacker inserts code through a data entry point created for regular users.")]),e("tr",null,[e("td",null,"SQL injection"),e("td",null,"A specific type of remote code execution attack where an attacker can exploit input fields that are not validated and send SQL commands through the web application to the database.")]),e("tr",null,[e("td",null,"Web applications"),e("td",null,"Applications that run on a web server, which can be accessed by a user's web browser over the internet.")]),e("tr",null,[e("td",null,"Structured Query Language (SQL)"),e("td",null,"A language designed to manage and manipulate databases. SQL requests are called queries.")]),e("tr",null,[e("td",null,"Relational database"),e("td",null,"A type of database that organizes data into tables that can be linked—or related—based on data common to each.")]),e("tr",null,[e("td",null,"Authentication bypass"),e("td",null,"A type of SQL injection attack used to log into an application with administrative-level privileges without the required username and password.")]),e("tr",null,[e("td",null,"Compromised data integrity"),e("td",null,"A type of SQL injection attack used to deface a web page by inserting malicious content onto the web page or altering the contents of the database.")]),e("tr",null,[e("td",null,"Information disclosure"),e("td",null,"A type of SQL injection attack used to obtain sensitive data from a database.")]),e("tr",null,[e("td",null,"Compromised availability of data"),e("td",null,"A type of SQL injection attack used to remove information from a database, delete logs, or alter information stored in a database.")]),e("tr",null,[e("td",null,"Blind SQL injection"),e("td",null,"A type of SQL injection attack used to ask true/false questions to perform reconnaissance. This can be used when other types of SQL injection attempts fail.")]),e("tr",null,[e("td",null,"Second order SQL injection"),e("td",null,"A type of SQL injection attack that causes destruction from a secondary query. A query fragment is injected in a user input field. The fragment is then executed in a second query that lacks validation.")])])],-1),t('<p>This section helps you prepare for the following certification exam objectives:</p><table><thead></thead><thead><tr><th scope="col" class="fw-bold"> Exam</th><th scope="col" class="fw-bold"> Objective</th></tr></thead><tbody><tr><td>CompTIA CySA+ CS0-003</td><td>2.2 Given a scenario, analyze output from vulnerability assessment tools <br><ul><li>Tools</li><ul><li>Web application scanners <ul><li>Burp Suite</li></ul></li></ul></ul><p>2.4 Given a scenario, recommend controls to mitigate attacks and software vulnerabilities</p><ul><li>Injection flaws</li></ul></td></tr><tr><td>TestOut CyberDefense Pro</td><td>2.1 Perform threat analysis <ul><li>Internal vs. external scanning</li></ul></td></tr></tbody></table><h3 id="_6-4-1-sql-injection" tabindex="-1"><a class="header-anchor" href="#_6-4-1-sql-injection"><span>6.4.1 SQL Injection</span></a></h3><p>Click one of the buttons to take you to that part of the video.</p><p>SQL Injections 00:00-00:19 In this lesson, I&#39;m going to discuss remote code execution and one specific type of attack we call SQL injection. Remote code execution, or code injection, is a very common form of cyberattack and one of the most damaging.</p><p>Remote Code Execution 00:19-00:33 There are many ways attackers do this, but basically all methods include attackers inserting their own code through data entry points created for regular users in such a way that the server accepts the malicious code as legitimate.</p><p>SQL injection 00:33-00:53 If an attacker can get a target&#39;s server to execute the malicious code, he or she can do all kinds of damage. To better understand how this works, let&#39;s take a closer look at how SQL injection occurs. These attacks are powerful and complex, and they&#39;re behind many successful high-profile internet security breaches.</p><p>SQL Injection Attacks 00:53-01:46 For example, in 2011, Sony was targeted by a SQL injection attack that compromised over one million emails, usernames, and passwords. In 2013, the U.S. Department of Energy was targeted, and at least 100,000 employee records were compromised. These records included contact information, social security numbers, and even bank account numbers. Perhaps the most ironic attack occurred when mysql.com was attacked, releasing a large list of usernames and passwords to hackers. In each of these instances, the vulnerability wasn&#39;t in the SQL software but in the way the websites and applications were implemented. Each of these attacks could&#39;ve been prevented with careful front-end configuration. Now, because SQL injection attacks target web applications, let&#39;s review how they work as well.</p><p>Web Applications 01:46-02:11 When a user connects to a web application, they make the initial request through the browser. This request travels over the internet to the web server. The web server accepts the request and sends it to the corresponding web app. The web app accesses the database, completes the requested task, and then responds back. Once the transaction is complete, the web server sends the requested information to the user&#39;s browser.</p><p>Databases 02:11-03:30 Motivation for a SQL injection attack is often the information that&#39;s stored in the application&#39;s database. Databases hold a variety of information, such as application details, configuration data, customer information, login credentials, and more. And there are different types of databases based on how the data is stored.</p><p>SQL was specifically designed to request data from a relational database with requests called queries. A relational database is a storage bank for data that&#39;s organized in tables that are linked by keys, which are unique identifiers. With these keys, data in tables can be searched and sorted through multiple parameters.</p><p>It&#39;s important to note once again that SQL injections are the result of flaws in web applications, not in the database or web server. These attacks exploit input fields that aren&#39;t validated and use them to send SQL commands through the web application to the database. Code can be added to the existing code before it&#39;s sent to the database and executed. If the injection is successful, the malicious code runs on the back-end database and returns the requested information. Let&#39;s look at a very basic example to see how this works.</p><p>How SQL Injections Work 03:30-04:16 Let&#39;s say Bob Smith is logging into his account. Normally, Bob enters his username—bobsmith—and password—secret—into the appropriate spaces. Once he clicks Submit, the web application sends a string to the web server that contains the credentials. The command tells the database to check for the provided username and compare it to the stored password before granting access. Assuming Bob&#39;s credentials are found, he&#39;s directed to the requested page. As you can see in this example, the data that Bob entered is put into the same query as the commands. As a result, this code is susceptible to SQL injection attacks. If the programmer didn&#39;t restrict the login fields, an attacker could add any code to them.</p><p>SQL Injection Example 04:16-05:18 Let&#39;s say the attacker knows Bob&#39;s username but not his password. He or she might be able to enter bobsmith&#39;-- in the username field. The single quote mark indicates that the data has ended, and a command is beginning. The double dashes indicate that the code is ending and a comment is being entered. Comments are code that the program doesn&#39;t execute. They usually contain explanations or reminders for the programmer. Because of this, the application knows to ignore the comments. Now, because the command treats everything after the dashes as comments, the instruction to verify the username with the corresponding password is no longer visible, and the attacker is granted access to Bob&#39;s account.</p><p>This was just a basic example, but most SQL injection attacks are extremely complex and require a high level of database and coding expertise. The work involved in a successful SQL injection is paid off with big rewards of data or money, though.</p><p>SQL Injection Attack Types 05:18-07:03 Let&#39;s briefly review some of these more complex attacks. First, is our example of Bob Smith. That attack process is called an authentication bypass attack. When an attacker attempts an authentication bypass, he or she logs into an application with administrative privileges without having to provide valid credentials. Imagine Bob in our previous example is an administrator, and now the attacker has administrative privileges just like Bob.</p><p>The next kind of SQL injection attacks, which are called compromised data integrity attacks, focus on altering a database&#39;s data in order to deface or damage a website. An information disclosure attack is focused on obtaining sensitive data from the database. This could be anything from credentials to finances to personal account information. Really, it&#39;s anything that a large database could potentially contain. Another form of this attack, called a compromised availability of data attack, focuses on deleting or altering data.</p><p>A blind SQL injection is an even more complex attack. An attacker might try this if they&#39;re unsuccessful with their initial SQL injection. A blind SQL injection performs reconnaissance or alters authentication credentials. For example, an attacker asks true or false questions to determine the information he or she is seeking. And finally, we have a second order SQL injection. This attack gets its name because its destruction comes from a secondary query. This can be accomplished by injecting a query fragment into a user-input field and then having that fragment execute in a secondary query that lacks validation.</p><p>Summary 07:03-07:19 That&#39;s it for this lesson. In this lesson, we talked about remote code execution through SQL injections. We discussed how SQL injection attacks work and looked at several types.</p><h3 id="_6-4-2-sql-injection-facts" tabindex="-1"><a class="header-anchor" href="#_6-4-2-sql-injection-facts"><span>6.4.2 SQL Injection Facts</span></a></h3><p>Remote code execution, also known as code injection, is a common form of cyber attack and one of the most damaging. The attacker inserts code through a data entry point created for regular users. The malicious code is entered in a way that the server accepts the code as legitimate. SQL injection is a specific type of remote code execution attack.</p><p>This lesson covers the following topics:</p><ul><li>Web applications</li><li>Structured Query Language (SQL)</li><li>SQL injection</li></ul><h4 id="web-applications" tabindex="-1"><a class="header-anchor" href="#web-applications"><span>Web Applications</span></a></h4><p>Because SQL injection attacks target web applications, it is important to understand how web applications work. The web application process is typically:</p><ul><li>A user connects to a web application and makes a request through the browser.</li><li>The request goes over the internet to the web server.</li><li>The web server accepts the request and sends it to the corresponding web application.</li><li>The web application accesses the database, completes the requested task, and responds to the web server.</li><li>The web server sends the requested information back to the user&#39;s browser.</li></ul><h4 id="structured-query-language-sql" tabindex="-1"><a class="header-anchor" href="#structured-query-language-sql"><span>Structured Query Language (SQL)</span></a></h4><p>SQL injection attacks most often target information stored in the application&#39;s database. Important facts to know about databases and SQL are:</p><ul><li>Databases store a variety of information, such as: <ul><li>Application data</li><li>Configuration data</li><li>Customer data</li><li>Login credentials</li></ul></li><li>Key points to remember about databases are: <ul><li>A database is named based on how its data is stored.</li><li>A relational database is a storage bank for data organized in tables linked by a key. <ul><li>Keys are unique identifiers.</li><li>Because the tables are connected through keys, they can be searched and sorted by multiple parameters.</li></ul></li><li>SQL was specifically designed to request data from a relational database.</li><li>SQL requests are called queries.</li></ul></li></ul><h4 id="sql-injection" tabindex="-1"><a class="header-anchor" href="#sql-injection"><span>SQL Injection</span></a></h4><p>Key points to remember regarding SQL injection attacks are:</p>',31),e("ul",null,[e("li",null,"An attacker can exploit input fields that are not validated."),e("li",null,"The attacker sends SQL commands through the web application to the database."),e("li",null,"An attacker can add code to the existing code before it is sent to the database and executed."),e("li",null,[o("The malicious code runs on the backend database and returns the requested information. "),e("div",{class:"info","data-block":`
SQL injections are the result of web
application flaws, not flaws in the database or server.`},[e("div",{class:"to-info-box"},[e("div",{class:"to-info-box-body"},[e("div",{class:"to-icon small","aria-hidden":"true",style:{width:"20px"}},[e("svg",{"aria-hidden":"true",focusable:"false","data-prefix":"fal","data-icon":"circle-info",class:"svg-inline--fa fa-circle-info",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},[e("path",{fill:"currentColor",d:"M256 32a224 224 0 1 1 0 448 224 224 0 1 1 0-448zm0 480A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM208 352c-8.8 0-16 7.2-16 16s7.2 16 16 16l96 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0 0-112c0-8.8-7.2-16-16-16l-40 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l24 0 0 96-32 0zm48-168a24 24 0 1 0 0-48 24 24 0 1 0 0 48z"})])]),e("div",{class:"to-info-box-body-content"},[e("span",null," SQL injections are the result of web application flaws, not flaws in the database or server.")])])])])])],-1),t('<p>A simplified scenario of SQL injection is:</p><ul><li>The login fields have not been restricted. Therefore, an attacker can add any characters to the fields.</li><li>The attacker knows the username but not the password. The attacker enters <b class="fw-bold"><i class="fs-italicize">username&quot;--</i></b> <span style="color:rgb(79, 79, 79);font-family:arial;font-size:13px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial;display:inline !important;float:none;"></span> in the username field. <ul><li>The quotation mark indicates that data has ended and a command is beginning.</li><li>The double dashes indicate that code is ending and a comment is being entered. Comments are code that a program does not execute. They are usually used for explanations or reminders for the coder.</li><li>Because everything after the double dashes is treated as comments, the command to verify the username with a given password is no longer visible. The attacker is granted access to the user account.</li></ul></li></ul><p>This is a basic scenario. Most SQL injection attacks are extremely complex and require a high level of database and coding expertise. The work involved in a successful SQL injection is paid off with big rewards. That is the draw for attackers.</p><p>The following table lists some types of SQL injection attacks.</p>',4),e("table",null,[e("thead",null,[e("tr",null,[e("th",{class_:"firstTableHeader",scope:"col",class:"fw-bold"}," Type"),e("th",{scope:"col",class:"fw-bold"}," Description")])]),e("tbody",null,[e("tr",null,[e("td",null,"Authentication bypass"),e("td",null,"SQL injection is used to log into an application with administrative-level privileges without the required username and password.")]),e("tr",null,[e("td",null,"Compromised data integrity"),e("td",null,"SQL injection is used to deface a web page by inserting malicious content onto the web page or altering the contents of the database.")]),e("tr",null,[e("td",null,"Information disclosure"),e("td",null,"SQL injection is used to obtain sensitive data from a database.")]),e("tr",null,[e("td",null,"Compromised availability of data"),e("td",null,"SQL injection is used to remove information from a database, delete logs, or alter information stored in a database.")]),e("tr",null,[e("td",null,"Blind"),e("td",null,"Blind SQL injection is used to ask true/false questions to perform reconnaissance. This can be used when other types of SQL injection attempts fail.")]),e("tr",null,[e("td",null,"Second order"),e("td",null,"Second order is a SQL injection attack that causes destruction from a secondary query. A query fragment is injected in a user input field. The fragment is then executed in a second query that lacks validation.")])])],-1),t('<h3 id="_6-4-3-sql-injection-attack-types" tabindex="-1"><a class="header-anchor" href="#_6-4-3-sql-injection-attack-types"><span>6.4.3 SQL Injection Attack Types</span></a></h3><p>Click one of the buttons to take you to that part of the video.</p><p>SQL Injection Attack Types 00:00-00:30 As a cyber defense analyst, you&#39;ll be better able to defend against SQL injection attacks if you personally have been through the process of conducting a variety of these attacks. Remember that a SQL injection attack is where an attacker gets a target web server to execute some malicious code by exploiting input fields that aren&#39;t properly validated. In this lesson, I&#39;ll discuss the methodology of these attacks and review some SQL injection attack types.</p><p>Information Gathering 00:30-01:00 The SQL injection methodology has four phases. The first phase is information gathering. The more information you collect in this phase, the more time you save throughout the process. To do this, first determine if the web application is connected to a database server. Next, inject code into fields to discover any error messages. And finally, review these error messages carefully for pertinent information about the operating system, database type, database version, and privilege level.</p><p>Vulnerability Testing 01:00-01:58 The second phase is testing for SQL injection vulnerabilities. You can use function testing, which requires little knowledge of the code&#39;s inner design logic. Function testing can be as simple as adding a tick mark at the end of a URL. If an error is returned, the web application might be vulnerable to a SQL attack.</p><p>Static and dynamic testing involve an analysis of the web application&#39;s source code and various tests for vulnerabilities. You can do this manually or with analysis tools. A benefit of static code analysis is that it&#39;s completed without execution. Dynamic analysis is executed at runtime to find vulnerabilities created through the interaction of the source code, database, or web service. And finally, fuzz testing is helpful in discovering coding errors. Fuzz testing works through automation of large volumes of random data inserted into input fields to expose output vulnerabilities.</p><p>Injection Attacks 01:58-03:16 The third phase in the methodology is to launch an actual SQL attack. There are two main categories of SQL injection, which we call in-band and blind, or inferential, injections. An in-band injection is the most common technique because one communication channel is used for both the information gathering and attack. This technique includes both error-based SQL injection, which depends on error messages for information about the database structure, and union-based injection, which uses the UNION operator to combine the results of multiple SELECT statements into one result.</p><p>Blind SQL injection is time-consuming because rather than receiving error messages or data, true or false results are returned. This technique is like the game of 20 questions, where you ask yes or no questions to determine the information you want. Each question can build on the previous questions to help you zero in on the important information. This technique has two methods. The first is content-based blind SQL injection, which uses a query to alter the HTTP response differently for true and false answers. The second is time-based blind SQL injection, which uses a query to alter the HTTP response time depending on whether it&#39;s a true or false answer.</p><p>Advanced SQL Injection 03:16-04:22 The fourth phase of the methodology is advanced SQL injection. Here you can use database, table, and column enumeration to assist in identifying user-level privileges and database structure. Next, you can try password grabbing. This involves retrieving a username and password from a user-defined table. Attackers can even transfer an entire database to their machine using advanced SQL injection by linking their database to the victim&#39;s server through OPENROWSET. The database structure is replicated, and the data is transferred through a remote connection.</p><p>Additionally, an attacker can interact with the base operating system by reading and writing system files from a disk or by using direct command execution through the remote shell. Of course, either of these options are limited by the database&#39;s privileges and permissions. Network reconnaissance is also possible during these advanced attacks. You can do this with the ipconfig, tracert, and netstat utilities, as well as by gathering IP information using reverse lookups and assessing network connectivity.</p><p>IDS Evasion 04:22-05:00 It&#39;s important to have an intrusion detection system, or IDS, in place on your network. These are designed to protect against known SQL injection attacks, and they alert administrators when these attacks are detected. So when you perform the SQL injection attacks to test your own system, see if you can avoid your IDS.</p><p>The most common detection avoidance method is to manipulate input strings to avoid matching known patterns. To do this, convert queries into hexadecimal characters, use whitespace generously, use comments to break up code statements, or use obscure formatting and word choice in your SQL statements.</p><p>Summary 05:00-05:27 That&#39;s it for this lesson. In this lesson, we reviewed SQL injection attack methodology, some different attack types, and a few techniques you can use to see if you can evade your IDS to test your defenses. By following these techniques, you&#39;ll be better able to find vulnerabilities in your applications and make the corrections needed to defend against SQL injection attacks.</p><h3 id="_6-4-4-sql-injection-attack-facts" tabindex="-1"><a class="header-anchor" href="#_6-4-4-sql-injection-attack-facts"><span>6.4.4 SQL Injection Attack Facts</span></a></h3><p>As a cyber defense analyst, conducting various SQL injection attacks yourself will better prepare you to defend against SQL injection attacks.</p><p>This lesson covers the following topics:</p><ul><li>SQL injection methodology</li><li>SQL injection tools</li><li>IDS evasion</li><li>Prompt injection</li><li>Unsecure object reference</li><li>Extensible Markup Language (XML) Attacks</li></ul><h4 id="sql-injection-methodology" tabindex="-1"><a class="header-anchor" href="#sql-injection-methodology"><span>SQL Injection Methodology</span></a></h4><p>The following table describes the four phases of the SQL injection methodology:</p><table><thead><tr><th scope="col" class="fw-bold"> Method <br></th><th scope="col" class="fw-bold"> Description <br></th></tr></thead><tbody><tr><td>Information gathering <br></td><td>The information gathered in this phase saves time later. Follow these steps: <ol type="1"><li>Determine the connection between the web application and the database server.</li><li>Inject codes into fields to generate and discover error messages. <br></li><li>Review the error messages to determine information about the following: <ul><li>Operating system</li><li>Database type</li><li>Database version</li><li>Privilege level</li></ul></li></ol></td></tr><tr><td>SQL injection vulnerability testing <br></td><td>You can use the following tests to help you locate SQL injection vulnerabilities: <ul><li>Function testing:</li><ul><li>Requires little knowledge of the code logic or inner design.</li><li>It can be as simple as adding a tick mark at the end of a URL.</li><li>This may indicate a SQL injection vulnerability if an error message is returned.</li></ul><li>Static testing:</li><ul><li>Can be done manually or with an analysis tool.</li><li>Tests the application&#39;s source code.</li><li>Can be completed without execution.</li></ul><li>Dynamic testing:</li><ul><li>Can be done manually or with an analysis tool.</li><li>Tests the application&#39;s source code.</li><li>Executes at runtime.</li><li>Finds vulnerabilities created by interacting with the source code, database, and web service.</li></ul><li>Fuzz testing:</li><ul><li>Helps reveal coding errors.</li><li>Works through automation of large volumes of random data inserted into input fields.</li><li>Produces output in which vulnerabilities are discoverable. <br></li></ul></ul></td></tr><tr><td>SQL injection attack execution</td><td>There are two general categories for SQL injection attack execution: <ul><li>In-band:</li><ul><li>It is the most common form of SQL injection attack.</li><li>Uses one communication channel for information gathering and attack execution.</li><li>Includes:</li><ul><li>Error-based SQL injection that provides information about the database structure.</li><li>Union-based SQL injection that uses the UNION operator to combine the results of multiple SELECT statements into one result.</li></ul></ul><li>Blind or inferential:</li><ul><li>It is time-consuming. Information is received through true/false results rather than error messages.</li><li>Includes two methods: <ul><li>Content-based blind SQL injection that uses a query to alter the HTTP response differently for true and false answers.</li><li>Time-based blind SQL injection that uses a query to alter the HTTP response time differently for true and false answers.</li></ul></li><ul></ul></ul></ul></td></tr><tr><td>Advanced SQL injection</td><td>Advanced SQL injection includes several additional steps you can take, including: <ul><li>Use database, table, and column enumeration to identify user privilege level and database structure.</li><li>Grab usernames and passwords from a user-defined table.</li><li>Transfer an entire database to a remote machine. You can link the server to the remote database (an attacker&#39;s database) using OPENROWSET. The database is replicated, and then the data is transferred.</li><li>Interact with the operating system. You can read and write system files from disk with appropriate permission and privileges or use direct command execution through the remote shell.</li><li>Perform network reconnaissance. You can use ipconfig, tracert, netstat, and IP information gathering through reverse lookups. You can also assess network connectivity.</li></ul></td></tr></tbody></table><h4 id="sql-injection-tools" tabindex="-1"><a class="header-anchor" href="#sql-injection-tools"><span>SQL Injection Tools</span></a></h4><p>The following table describes SQL injection tools:</p><table><thead><tr><th scope="col" class="fw-bold"> Tool <br></th><th scope="col" class="fw-bold"> Description <br></th></tr></thead><tbody><tr><td>BSQL hacker <br></td><td>An injection framework that can exploit SQL injection vulnerabilities on most databases. <br></td></tr><tr><td>Havii <br></td><td>A SQL injection tool retrieves user and password hashes, conducts fingerprinting, accesses a file system, and executes commands. <br></td></tr><tr><td>Marathon</td><td>A SQL injection tool that uses heavy queries to complete time-based SQL blind injection attacks. <br></td></tr><tr><td>SQL power injector</td><td>A SQL injection tool that automates several threads of blind SQL injection simultaneously. <br></td></tr><tr><td>DroidSQLi</td><td>A SQL injection tool for mobile devices running on an Android system that does the following: <ul><li>Tests MySQL web applications.</li><li>Supports time-based, error-based, normal, and blind injections.</li></ul></td></tr></tbody></table><h4 id="ids-evasion" tabindex="-1"><a class="header-anchor" href="#ids-evasion"><span>IDS Evasion</span></a></h4><p>It is crucial to have an intrusion detection system (IDS). An IDS is designed to protect against known SQL injection attacks and alert administrators to attacks. When performing SQL injection attacks to test your system, remember to take steps to avoid being detected.</p><p>The most common detection avoidance method is manipulating input strings to avoid matching known patterns. There are various techniques to obscure the input strings to avoid IDS detection.</p><p>Signature detection systems create a database of SQL injection attack strings known as signatures. The signatures are compared to the input strings to detect attacks. The following table describes the IDS evasion techniques:</p><table><thead><tr><th scope="col" class="fw-bold"> Technique <br></th><th scope="col" class="fw-bold"> Description <br></th></tr></thead><tbody><tr><td>Char encoding <br></td><td>Char encoding uses the CHAR function to represent a character. <br></td></tr><tr><td>In-line comments <br></td><td>An in-line comment inserts comments between SQL keywords to obscure the strings. <br></td></tr><tr><td>Obfuscated codes</td><td>Obfuscation makes SQL codes hard to recognize by altering them to isolate the basic SQL commands from other control components of the query. <br></td></tr><tr><td>Whitespace manipulation</td><td>Whitespace manipulation puts extra whitespace between SQL keywords to obscure the input strings. <br></td></tr><tr><td>Hex coding</td><td>Hex coding replaces an SQL query with a hexadecimal code. <br></td></tr></tbody></table><h4 id="prompt-injection" tabindex="-1"><a class="header-anchor" href="#prompt-injection"><span>Prompt Injection</span></a></h4><p>Prompt injection vulnerabilities can pose significant risks to language models and chatbots, which rely heavily on user input. These risks include manipulating the language model&#39;s behavior, data theft or leakage, and bias and misinformation. An attacker can inject malicious code or commands into the chatbot&#39;s input field, causing it to respond with inappropriate or harmful messages or take actions that compromise privacy or security. Additionally, prompt injection attacks can insert biased or false information into the language model&#39;s training data, leading to biased or inaccurate models that produce misleading or harmful results.</p><p>One notable example is the Tay chatbot created by Microsoft, which was launched on Twitter in 2016 and quickly became the target of prompt injection attacks. Tay was designed to learn from user interactions and develop sophisticated conversational qualities. Unfortunately, within a few hours of its launch, Tay began responding to user input with racist, sexist, and otherwise offensive messages, prompting Microsoft to shut it down. Attackers deliberately supplied the Tay chatbot with inflammatory and objectionable input to manipulate its behavior and responses. The attacks were possible because Tay was vulnerable to prompt injection.</p><p>The Tay incident highlights the risks of prompt injection attacks on language models and chatbots, and it underscores the importance of robust validation measures to detect and prevent such attacks.</p><h4 id="unsecure-object-reference" tabindex="-1"><a class="header-anchor" href="#unsecure-object-reference"><span>Unsecure Object Reference</span></a></h4><p>A direct object reference refers to the actual name of a system object that the application uses. If an attacker can manipulate a parameter that directly references an object, the attacker can craft that parameter to grant access to other things the attacker would typically be unauthorized to access. For example, a call to a SQL database may request account information by directly referencing the acctname parameter. An attacker may replace the acctname parameter with a different account name or number, granting them access to that account if the object reference is unsecure.</p><p><code>/webpage.php/order?acctname=bob</code></p><p>An attacker can arbitrarily change bob to alice. If the object reference is unsecure, the query will still work:</p><p><code>/webpage.php/order?acctname=alice</code></p><p>Direct object references are typically unsecure when they do not verify whether a user is authorized to access a specific object. Therefore, it is essential to implement access control techniques in applications that work with private information or other types of sensitive data.</p><h4 id="extensible-markup-language-xml-attacks" tabindex="-1"><a class="header-anchor" href="#extensible-markup-language-xml-attacks"><span>Extensible Markup Language (XML) Attacks</span></a></h4><p>Extensible Markup Language (XML) is used by web applications for authentication and authorizations and other types of data exchange and uploading. Data submitted via XML without encryption or input validation is vulnerable to spoofing, request forgery, and arbitrary data or code injection. Other types of attacks target the way a server parses an XML file submitted for upload or XML data presented as a URL:</p><ul><li>XML bomb (Billion Laughs attack) - The XML encodes entities that expand to exponential sizes, consuming memory on the host and potentially crashing it.</li><li>XML External Entity (XXE) - This attack embeds a request for a local resource, such as the server&#39;s password file.</li></ul><h3 id="_6-4-5-exploit-sql-on-a-web-page" tabindex="-1"><a class="header-anchor" href="#_6-4-5-exploit-sql-on-a-web-page"><span>6.4.5 Exploit SQL on a Web Page</span></a></h3><p>Click one of the buttons to take you to that part of the video.</p><p>Exploit SQL on a Web Page 00:00-01:02 The internet used to be pretty simple and straightforward. There was no JavaScript, Flash, CSS, backend databases, or, really, any complex web design technologies. That&#39;s all changed, and it&#39;s changing more rapidly than ever. These days, most websites are dynamic and database-driven. Site content is dependent on user input most of the time, and that data is written to a database, typically an SQL database. Like every other piece of computing technology that&#39;s invented to solve a problem, hackers have figured out how to attack these databases.</p><p>The term for attacking an SQL database is an SQL injection. It&#39;s a very common way to attack databases. The Open Web Application Security Project, OWASP, almost always includes weak SQL databases in their list of the top ten most widely exploited vulnerabilities.</p><p>In this demo, we&#39;re going to cover a few SQL injections on a vulnerable web page. This isn&#39;t a demo on SQL in general. We&#39;re just taking a quick look at some things to be aware of as a security analyst.</p><p>Our Setup 01:02-01:26 I&#39;m on a Windows 10 system. I&#39;ve already done a few things to it. First, I&#39;ve downloaded and installed XAMPP, which is a package that contains Apache, MariaDB, PHP, and Perl. I&#39;ve also downloaded and configured the Darn Vulnerable Web Application, DVWA, which is a vulnerable PHP and MySQL web application designed for security professionals to practice their analysis skills on.</p><p>Find Username Accounts with SQL Injection 01:26-02:14 First, we want to do a few simple injections. Let&#39;s start out by typing in a number, number &#39;1&#39;. Click Submit. Now let&#39;s type in &#39;2&#39; and click Submit. All this does is give you the user ID, first name, and surname. That&#39;s not very useful, but it does show that it&#39;s not designed very well. We want to get more than that, so let&#39;s expand on our SQL injection.</p><p>We&#39;re going to enter code to pull up records for a specific user. By crafting our input, we can get more from the output than the code author intended. So, let&#39;s enter in the number 1, which is the user ID, with a single quote followed by a true statement. Our true statement can be anything that&#39;s true, such as 1 is equal to 1. It will look like this: &#39;1&#39; and 1=1#&#39;. Click Submit. We see the first name and the surname for that user.</p><p>Find the Database Name and Username 02:14-02:39 Now let&#39;s go a little further. Let&#39;s say we want to find out our database name and username for the database. For that, I&#39;ll do a select statement by entering in ‘1&#39; and 1=1 union select database(), user()#&#39;and press Enter. Now, down here, I get the name of my database, which is dvwa, and the username is root@localhost.</p><p>Find a List of Tables 02:39-03:14 I want to see if I can get a list of tables from our database. For that, I&#39;ll do another select statement and enter in &#39;1&#39; and 1= union select null, table_name from information_schema.tables#&#39; and press Submit. Okay. I just got a long list of tables here. I&#39;m looking for something that might have a list of usernames and passwords in it. Right here, I see a table called users, so I wonder if that might be the list of users along with their passwords? There&#39;s one way to find out: let&#39;s see if we can pull information from that table.</p><p>Find Usernames and Passwords from a Table 03:14-03:35 To pull the information out of the Users table, I&#39;ll enter in the following select statement: &#39;1&#39; and 1= union select user password from users#&#39; and click Submit. Here, you can see a nice list of the usernames along with the password hashes for each one. Now this is all someone would need to run these hashes through a cracking program to attempt to crack these hashes.</p><p>Summary 03:35-04:01 And that&#39;s it for this demo. In this demo, we used a vulnerable website to demonstrate some SQL injections. First, we found a list of users. Then we expanded to find the name of the database and the username. We ended by finding a list of tables, specifically the user table, and then retrieved the usernames and password hashes from that table.</p><h3 id="_6-4-6-find-sql-injection-flaws-with-sqlmap" tabindex="-1"><a class="header-anchor" href="#_6-4-6-find-sql-injection-flaws-with-sqlmap"><span>6.4.6 Find SQL Injection Flaws with sqlmap</span></a></h3><p>Click one of the buttons to take you to that part of the video.</p><p>Find SQL Injection Flaws with Sqlmap 00:00-00:28 SQL injection is a very common web attack technique, but it does require quite a bit of knowledge and time to test for manually. In this demo, we&#39;ll be looking at a tool that automates the detection and use of a SQL injection. The tool is called sqlmap and is easily installed on most operating systems. We&#39;ll be using Kali Linux, as sqlmap comes pre-installed and we can save some time there.</p><p>Find Potentially Vulnerable Parameters 00:28-01:29 To begin using sqlmap, we need two things—a potentially vulnerable website and a potentially vulnerable form on that site. If I navigate to this demo website I have here, you can see it&#39;s quite simple and made specifically for this demo, so I know it has a SQL injection vulnerability. There&#39;s really only one form here, so I can probably assume the parameter in question is related to that form. In most browsers, I can use Developer Tools to view the Form Data and get that parameter. So, If I open Developer Tools and go to the Network tab, I can select a category and click Submit. We can see some activity in the Network tab here. If I select the page that loaded welcome.php, I can scroll down to the bottom and see the Form Data. Chrome displays Form Data in this nice format. But if we want to see the raw string, we can simply click View Source and see the data passed in. We&#39;ll need to remember this parameter—&#39;catid&#39;—for the next step.</p><p>Use Sqlmap to Test Vulnerable Parameters 01:29-02:36 Now that we have our website and parameter, we can open up a terminal and begin using sqlmap. If we want, we can type ‘sqlmap -h&#39; to view all the options. We can see there&#39;s a Wizard option, which will walk us through the process. So I&#39;ll just run that using ‘sqlmap --wizard&#39;. Now, it&#39;s prompting us for the URL of our target. I&#39;ll go ahead and type in ‘http://localhost&#39; and it then asks us for the parameter. We got that in the previous step, so I&#39;ll go ahead and just give it that parameter, which was ‘catid=1001&#39;, and hit Enter. Then sqlmap basically asks how hard we think this injection is going to be. I happen to know it&#39;s pretty basic, so I can just choose the Normal recommended level. It then asks how mow much enumeration we want to allow it to do if it finds a vulnerability. This is basically saying how much database information do we want sqlmap to display if it finds something. I know this database isn&#39;t too large, so I&#39;ll choose Intermediate. Now, sqlmap is doing its thing and will spit out a lot of information here about the database.</p><p>Navigate a Database with Sqlmap 02:36-04:01 Ok, looks like sqlmap has finished, and if we scroll up, we see sqlmap displays the injections it tested. It then goes on to show us some info about the database back end. It shows which operating system it&#39;s running on, the MySQL version, and information about the database name and user.</p><p>If we scroll back down, we can see it lists out the application-specific tables that it&#39;s found inside appd. We have a Category table, a Products table, and a Users table. If we continue to scroll down, we can see the columns inside this table include a Passwords column.</p><p>Sqlmap allows us to go even further and dump out the contents of this table so we can see the users in this app. To do this, we need to use some additional flags with sqlmap. So if we want to view the user table, we start sqlmap and use the ‘url&#39; option, and then we specify the website&#39;s url, which is ‘http://localhost&#39;. We then tell it we&#39;re interested in the ‘users&#39; table by using the capital ‘T&#39; option. Lastly, since we want to view the contents of the table, we tell it to dump the data using the ‘dump&#39; option. We can now run the command. And since we ran that sqlmap wizard earlier, sqlmap remembers this site and is able to execute much faster since it already knows which injections will work.</p><p>We can now see the Users table of this site and also see that they&#39;re storing passwords in plaintext, which is another strike on this site&#39;s security checklist.</p><p>Summary 04:01-04:22 That&#39;s it for this demo. In this demo, we went over sqlmap, which is a tool that automates the process of finding and exploiting SQL injection vulnerabilities. We showed how someone could find a vulnerable parameter on a website and use sqlmap to navigate through the back-end database to list out information that&#39;s supposed to be secret.</p><h3 id="_6-4-7-hidden-field-manipulation-attacks" tabindex="-1"><a class="header-anchor" href="#_6-4-7-hidden-field-manipulation-attacks"><span>6.4.7 Hidden Field Manipulation Attacks</span></a></h3><p>Click one of the buttons to take you to that part of the video.</p><p>Hidden Field Manipulation Attacks 00:00-00:22 For a hacker, finding a poorly constructed website is like winning the lottery. I&#39;m not talking about sites with poor navigation, lots of flashy glitter, or too much animation; I&#39;m talking about the code. Inexperienced web designers or people that just aren&#39;t great at coding often create websites that are easy to hack.</p><p>input type=&quot;hidden&quot; 00:22-00:43 One poor design choice is a hidden field. Hidden fields are used programmatically to pass information about the current page to the server.</p><p>For example, let&#39;s say a user fills out an inquiry form, and we want to obtain their IP address by using a snippet of PHP. We might also want to grab the referring page&#39;s URL. We&#39;re going to use a hidden field as a method for authenticating to a server.</p><p>Find a Password on a Website 00:43-02:25 We&#39;re going to use this website for RMK Supplies. If I scroll down a bit, you can see I have some links down here, at the bottom. But I also have a super-secret portal for only the very best customers, and there are no direct links on the site.</p><p>If I go up to the address bar, I&#39;ll type in &#39;/users&#39; at the end of the URL to take me to the secret login page for my best customers. Now, I&#39;m really proud of myself for making this site without any help--but my web developing skills aren&#39;t the best, as we&#39;re about to see.</p><p>One of the first things you do to check out a web design is look at the source code. If I right-click, I can select View Page Source. When I scroll down, I might want to look for the word &quot;Password.&quot; Here, I find that the action for the form sends us to the page index.php. Let&#39;s check that out and see what happens.</p><p>I&#39;ll enter in some text here and click on Submit. And when I do, it takes me to index.php. But I didn&#39;t type in the correct password.</p><p>Now, let&#39;s go back to the page source. And this time, I&#39;m looking for this right here, password.php. Whatever is typed in our password field is compared to the password in this password.php file. Now, let&#39;s find out if we can see what&#39;s in the password.php file.</p><p>I&#39;ll come up to the address bar, add &#39;password.php&#39; at the end, and press Enter. Over here, you can see that the file contains the password for the site, so let&#39;s give this a try.</p><p>I&#39;ll go back to the login page and type in the password again. Press Enter, and voilà, we&#39;re logged in. Now, don&#39;t get to excited--there aren&#39;t a lot of sites out there that are coded this poorly, but they do exist.</p><p>One final note: many capture-the-flag competitions use hidden fields as one of the challenges. They&#39;re a great way to practice the ethical hacking skills you learn in this course.</p><p>Summary 02:25-02:37 That&#39;s it for this demo. We discussed hidden fields on websites, and then we looked at a poorly designed site and saw how to find its password.</p>',77)]))}const h=i(r,[["render",l],["__file","6.4.html.vue"]]),u=JSON.parse('{"path":"/CyberDefensePro/6.4.html","title":"2.1 Regulations and Standards","lang":"zh-CN","frontmatter":{"lang":"zh-CN","title":"2.1 Regulations and Standards","description":"some description"},"headers":[{"level":2,"title":"Section 6.4 SQL Injection","slug":"section-6-4-sql-injection","link":"#section-6-4-sql-injection","children":[{"level":3,"title":"6.4.1 SQL Injection","slug":"_6-4-1-sql-injection","link":"#_6-4-1-sql-injection","children":[]},{"level":3,"title":"6.4.2 SQL Injection Facts","slug":"_6-4-2-sql-injection-facts","link":"#_6-4-2-sql-injection-facts","children":[]},{"level":3,"title":"6.4.3 SQL Injection Attack Types","slug":"_6-4-3-sql-injection-attack-types","link":"#_6-4-3-sql-injection-attack-types","children":[]},{"level":3,"title":"6.4.4 SQL Injection Attack Facts","slug":"_6-4-4-sql-injection-attack-facts","link":"#_6-4-4-sql-injection-attack-facts","children":[]},{"level":3,"title":"6.4.5 Exploit SQL on a Web Page","slug":"_6-4-5-exploit-sql-on-a-web-page","link":"#_6-4-5-exploit-sql-on-a-web-page","children":[]},{"level":3,"title":"6.4.6 Find SQL Injection Flaws with sqlmap","slug":"_6-4-6-find-sql-injection-flaws-with-sqlmap","link":"#_6-4-6-find-sql-injection-flaws-with-sqlmap","children":[]},{"level":3,"title":"6.4.7 Hidden Field Manipulation Attacks","slug":"_6-4-7-hidden-field-manipulation-attacks","link":"#_6-4-7-hidden-field-manipulation-attacks","children":[]}]}],"git":{"updatedTime":1746581938000},"filePathRelative":"CyberDefensePro/6.4.md"}');export{h as comp,u as data};
